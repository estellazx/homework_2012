<base href="http://ulcar.uml.edu/~iag/CS/Fibonacci.html">
<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="Author" CONTENT="Ivan A. Galkin">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.01 [en] (WinNT; U) [Netscape]">
   <TITLE>Fibonacci Numbers Spelled Out</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">

<H1>
Fibonacci Numbers Spelled Out</H1>

<ADDRESS>
by Ivan Galkin,</ADDRESS>

<ADDRESS>
U.MASS Lowell</ADDRESS>

<ADDRESS>
Materials for 91.503 Algorithms</ADDRESS>

<ADDRESS>
&nbsp;</ADDRESS>

<TABLE BORDER CELLPADDING=7 WIDTH="70%" >
<TR>
<TD WIDTH="100%"><I>"Spelled Out</I>" series contains all derivations usually
omitted by gurus and left for the reader to agonize over. Spelled out documents
are written in a free style to ease the pain.</TD>
</TR>
</TABLE>

<H3>
1. Fibonacci Numbers, or "How many rabbits will you get after a year?"</H3>
Here they are:

<P><I>&nbsp;&nbsp;&nbsp; 0, 1, 1, 2, 3, 5, 8, 13, 21, 34, ...</I>

<P>each number is a sum of two previous.

<P>We can write a <I>difference equation</I> for Fibonacci numbers as:
<TABLE BORDER=0 CELLPADDING=10 WIDTH="100%" >
<TR>
<TD WIDTH="50%">
<BLOCKQUOTE><IMG SRC="recurse.gif" start="fileopen" HEIGHT=70 WIDTH=204 ALIGN=CENTER></BLOCKQUOTE>
</TD>

<TD WIDTH="50%">
<DIV ALIGN=right>(1)</DIV>
</TD>
</TR>
</TABLE>

<H3>
2. Generating Function Approach</H3>
A useful way to describe an integer sequence is to construct a generating
function <I>B</I>(<I>x</I>):
<TABLE BORDER=0 CELLPADDING=10 WIDTH="100%" >
<TR>
<TD>
<BLOCKQUOTE>
<CENTER><IMG SRC="GF.gif" HEIGHT=41 WIDTH=248 ALIGN=LEFT>&nbsp;</CENTER>
</BLOCKQUOTE>
</TD>

<TD>
<DIV ALIGN=right>(2)</DIV>
</TD>
</TR>
</TABLE>
whose coefficients <I>b</I><SUB>i</SUB> <B>are</B> the sequence. <I>B</I>(<I>x</I>)
is a <I>power series</I> over a purely formal variable x. ("Power" series
just indicates that the powers of <I>x</I> are used in the series.)

<P>The whole point of building <I>B</I>(<I>x</I>) is to figure out an analytic
formula for those <I>b</I><SUB>i</SUB>. The usual trick is to find a <I>closed
form expression</I> for <I>B</I>(<I>x</I>) and tweak it.
<H4>
2.1 Closed-form expression</H4>
Some power series are able to converge to an expression which does not
include infinite summation anymore. For instance, an infinite sequence
of the numbers (dear to our hearts):
<UL><I>1, 2, 4, 8, 16, 32, 64, 128, 256 ...</I></UL>
&nbsp;can be represented by a generating function:
<BLOCKQUOTE><IMG SRC="GF-simple.gif" HEIGHT=45 WIDTH=301></BLOCKQUOTE>
which can be, suprisingly, put in a closed form:
<BLOCKQUOTE><IMG SRC="GF-simple-CF.gif" HEIGHT=41 WIDTH=93></BLOCKQUOTE>
For this to happen, x must be less than 1 -- otherwise the sum terms grow
and it can not converge.
<BR>Just to give us a feeling, let's select <I>x</I> = 0.1:
<BLOCKQUOTE><IMG SRC="GF-simple-example.gif" HEIGHT=185 WIDTH=325></BLOCKQUOTE>
It works!
<TABLE BORDER CELLPADDING=10 WIDTH="100%" >
<TR>
<TD>
<CENTER>A popular closed form expression&nbsp;</CENTER>
</TD>

<TD>
<CENTER><IMG SRC="GF-popular.gif" HEIGHT=45 WIDTH=166 ALIGN=CENTER></CENTER>
</TD>

<TD>
<CENTER>(3)</CENTER>
</TD>
</TR>
</TABLE>

<H4>
2.2 Closed-form Expression for Fibonacci Numbers' Generating Function</H4>
So the idea is to assume a generic generating function (2) with coefficients
representing the Fibonacci numbers. Now we have to find some regularity
in the behavior of the coefficients.

<P>Here's the trick:
<TABLE BORDER=0 CELLPADDING=10 WIDTH="100%" >
<TR>
<TD WIDTH="50%">
<BLOCKQUOTE><IMG SRC="FN-equation-GF.gif" ALT="FN-equation-GF.gif (3522 bytes)" HEIGHT=360 WIDTH=481></BLOCKQUOTE>
</TD>

<TD VALIGN=BOTTOM WIDTH="50%">
<DIV ALIGN=right>(4)</DIV>
</TD>
</TR>
</TABLE>
And this is a closed-form expression for the Fibonacci numbers' generating
function.

<P>The point here is that generating function turns the recursive equation
(1) with two boundary conditions into something more managable.And it is
because it can kinda transform (<I>n</I>-1) terms into <I>xB</I>(<I>x</I>),
(n-2) into <I>x</I><SUP>2</SUP><I>B</I>(<I>x</I>), etc.
<H4>
2.4. Verifying Closed-Form Expression for Fibonacci #s GF by Long Division</H4>
Well, I studied "stolbikom" division in USSR, so I apologize if my arrangement
on the paper look confusing to you. It sure does to me. Check <A HREF="http://www.math.utep.edu/sosmath/algebra/factor/fac01a1/fac01a1.html">here</A>
for a polynomial division example I used to figure out US notation.
<BLOCKQUOTE><IMG SRC="FN-test-CFE.gif" ALT="FN-test-CFE.gif (1016 bytes)" HEIGHT=175 WIDTH=224></BLOCKQUOTE>
The point is -- here's our sequence <I>1</I>, <I>1</I>, <I>2</I>, <I>3</I>,
...&nbsp;&nbsp; er, where do I look for the answer, again? Oh well, the
top line. Now we see how GFs work -- if we expand them in series over <I>x</I><SUP>n</SUP>,
the original sequence is generated.
<H4>
2.5. Expanding Closed-form Expression for GF</H4>
The next step is to find a good (closed-form) expression for <I>k</I>-th
Fibonacci number.&nbsp; The basic idea is to expand the closed-form expression
for GF (4) back to the infinite power series. Well, there is a generic
way of expanding a ratio of polynomials into Taylor series around the poles.
Instead, we can use (courtesy of Bernulli) algebraic manipulation which
shall reduce (4) into a form of some known generating function expansion
(like (3)):
<BLOCKQUOTE><IMG SRC="GF-popular.gif" HEIGHT=45 WIDTH=166 ALIGN=CENTER></BLOCKQUOTE>
We shall find these <I>a</I> and <I>b</I> for the case of Fibonacci GF
(4).

<P>1. First, we have to split quadratic polynomial in the denominator of
(4):
<BLOCKQUOTE><IMG SRC="FN-CFE-step1.gif" ALT="FN-CFE-step1.gif (1372 bytes)" start="fileopen" HEIGHT=235 WIDTH=266></BLOCKQUOTE>
2. It really helps at this point to introduce a <I>"<A HREF="http://www.zometool.com/deepzome/golden.html">Golden
Section</A>"</I> or <I>"Divine Proportion"</I>, <FONT FACE="Symbol">F:</FONT>
<BLOCKQUOTE><IMG SRC="Golden-ratio.gif" ALT="Golden-ratio.gif (522 bytes)" HEIGHT=91 WIDTH=174></BLOCKQUOTE>
After that our generating function becomes:
<BLOCKQUOTE><IMG SRC="FN-CFE-step2.gif" ALT="FN-CFE-step2.gif (471 bytes)" HEIGHT=45 WIDTH=244></BLOCKQUOTE>
This is not good enough: we need constructions ( 1 - <I>bx</I> ) in the
denominator. So our next trick is:

<P>3.&nbsp;<IMG SRC="FN-CFE-step3.gif" ALT="FN-CFE-step3.gif (2116 bytes)" HEIGHT=154 WIDTH=579 ALIGN=TEXTTOP>

<P>4. Now, we split the fraction
<TABLE BORDER=0 CELLPADDING=10 WIDTH="100%" >
<TR>
<TD WIDTH="50%">
<BLOCKQUOTE><IMG SRC="FN-CFE-step4.gif" ALT="FN-CFE-step4.gif (2476 bytes)" HEIGHT=324 WIDTH=285></BLOCKQUOTE>
</TD>

<TD VALIGN=BOTTOM WIDTH="50%">
<DIV ALIGN=right>(6)</DIV>
</TD>
</TR>
</TABLE>
5. And, finally, we compare (6) to (3) to conclude:
<BLOCKQUOTE><IMG SRC="FN-CFE-step5.gif" ALT="FN-CFE-step5.gif (956 bytes)" HEIGHT=97 WIDTH=218></BLOCKQUOTE>
Here are our Fibonacci numbers:
<TABLE BORDER WIDTH="100%" >
<TR>
<TD WIDTH="50%">
<CENTER>Fibonacci Numbers, closed-form</CENTER>
</TD>

<TD WIDTH="50%">
<CENTER><IMG SRC="FN-CFE.gif" ALT="FN-CFE.gif (1016 bytes)" HEIGHT=105 WIDTH=221 ALIGN=CENTER>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
(7)</CENTER>
</TD>
</TR>
</TABLE>
&nbsp;
<BLOCKQUOTE>&nbsp;</BLOCKQUOTE>

<H2>
3. Characteristic Polynomial Approach</H2>
Another techcnique of solving difference equation (1) is to let <I>F</I><SUB>n</SUB>
to be a characteristic polynomial <I>r</I><SUP>n</SUP>, which appears to
quickly reduce (1) to
<BLOCKQUOTE><IMG SRC="FN-CP-roots.gif" ALT="FN-CP-roots.gif (970 bytes)" HEIGHT=150 WIDTH=190></BLOCKQUOTE>
These roots are different from what we had in Section 2.The general solution
to equation <I>F</I><SUB>n</SUB> =&nbsp; <I>r</I><SUP>n</SUP> will be all
possible combinations of roots <I>r</I><SUB>1</SUB> and <I>r</I><SUB>2</SUB>:
<BLOCKQUOTE><IMG SRC="FN-CP-solution.gif" ALT="FN-CP-solution.gif (622 bytes)" HEIGHT=54 WIDTH=213></BLOCKQUOTE>
Constants <I>A</I> and <I>B</I> can be found from the boundary conditions
<I>F</I><SUB>0</SUB>=0 and <I>F</I><SUB>1</SUB>=1:
<BLOCKQUOTE><IMG SRC="FN-CP-bounds.gif" ALT="FN-CP-bounds.gif (1414 bytes)" HEIGHT=181 WIDTH=220></BLOCKQUOTE>
So we arrive at familiar expression for Fibonacci numbers (7).

<P>&nbsp;
</BODY>
</HTML>
